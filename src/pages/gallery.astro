---
import BaseLayout from "../layouts/BaseLayout.astro";
import Section from "../ui/Section.astro";

const images = [
	"/images/03.jpg",
	"/images/05.jpg",
	"/images/04.jpg",
	"/images/02.jpg",
	"/images/01.jpg",
	"/images/06.png",
	"/images/07.png",
	"/images/08.png",
];
---

<style>
	.gallery-section {
		max-width: 1200px;
		margin: 0 auto;
		padding: 0 1rem;
	}

	.gallery-title {
		text-align: center;
		font-size: 2.4rem;
		font-weight: 700;
		color: var(--text);
		margin-bottom: 2rem;
	}

	/* ========================= REAL MASONRY GALLERY ========================= */
	.gallery-grid {
		columns: 3;
		column-gap: 1rem;
	}

	.gallery-item {
		break-inside: avoid;
		margin-bottom: 1rem;
		border-radius: 14px;
		overflow: hidden;
		position: relative;
		cursor: pointer;
	}

	.gallery-item img {
		width: 100%;
		height: auto; /* maintain real photo height */
		border-radius: 14px;
		transition: transform 0.4s ease;
	}

	.gallery-item:hover img {
		transform: scale(1.08);
	}

	.gallery-item::after {
		content: "";
		position: absolute;
		inset: 0;
		background: rgba(0, 0, 0, 0.25);
		opacity: 0;
		transition: 0.3s ease;
		border-radius: 14px;
	}

	.gallery-item:hover::after {
		opacity: 1;
	}

	/* ========================= LIGHTBOX ========================= */
	.lightbox {
		position: fixed;
		inset: 0;
		background: rgba(0, 0, 0, 0.8);
		display: flex;
		align-items: center;
		justify-content: center;
		visibility: hidden;
		opacity: 0;
		transition: 0.3s ease;
		z-index: 9999;
	}

	.lightbox.active {
		visibility: visible;
		opacity: 1;
	}

	.lightbox img {
		height: 100%;
		max-width: 820px;
		border-radius: 12px;
		box-shadow: 0 8px 35px rgba(0, 0, 0, 0.4);
	}

	.close-lightbox {
		position: fixed;
		top: 25px;
		right: 30px;
		font-size: 2.4rem;
		font-weight: bold;
		color: white;
		cursor: pointer;
		transition: 0.2s;
	}

	.close-lightbox:hover {
		color: var(--main);
	}

	/* ========================= RESPONSIVE ========================= */
	@media (max-width: 900px) {
		.gallery-grid {
			columns: 2;
		}
	}

	@media (max-width: 600px) {
		.gallery-grid {
			columns: 1;
		}
	}
</style>

<BaseLayout title="Gallery">
	<Section
		title="Gallery"
		subTitle="Captured moments of restored movement and confidence"
	>
		<div class="gallery-section">
			<div class="gallery-grid">
				{
					images.map((src) => (
						<div class="gallery-item" data-img={src}>
							<img src={src} alt="gallery image" loading="lazy" />
						</div>
					))
				}
			</div>
		</div>

		<!-- LIGHTBOX POPUP -->
		<div class="lightbox" id="lightbox">
			<span class="close-lightbox" id="closeLightbox">Ã—</span>
			<img id="lightboxImg" src="" alt="preview" />
		</div>
	</Section>
</BaseLayout>

<script is:inline>
	const items = document.querySelectorAll(".gallery-item");
	const lightbox = document.getElementById("lightbox");
	const lightboxImg = document.getElementById("lightboxImg");
	const closeBtn = document.getElementById("closeLightbox");

	items.forEach((item) => {
		item.addEventListener("click", () => {
			lightboxImg.src = item.dataset.img;
			lightbox.classList.add("active");
		});
	});

	closeBtn.addEventListener("click", () => {
		lightbox.classList.remove("active");
		lightboxImg.src = "";
	});

	lightbox.addEventListener("click", (e) => {
		if (e.target === lightbox) {
			lightbox.classList.remove("active");
			lightboxImg.src = "";
		}
	});
</script>
